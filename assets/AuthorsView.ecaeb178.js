var A=Object.defineProperty,I=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var k=(s,o,e)=>o in s?A(s,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[o]=e,g=(s,o)=>{for(var e in o||(o={}))U.call(o,e)&&k(s,e,o[e]);if(b)for(var e of b(o))$.call(o,e)&&k(s,e,o[e]);return s},x=(s,o)=>I(s,N(o));import{_ as F,a as f,c as p,o as c,b as _,x as C,h as B,e as S,v as T,d as n,n as D,f as V,g as j,y as q,F as K,m as z,p as M,j as O,u as Y,z as L,q as v,A as W,B as G}from"./index.5e5a8a69.js";const H=["onContextmenu"],J={key:1},P=["onKeyup"],Q={props:{author:{type:Object,required:!0},field:{type:String,required:!0}},emits:{"update-field":null},setup(s,{emit:o}){const e=s,a=f(e.author[e.field]),i=p(()=>a.value===""&&e.author.death_year===""),h=p(()=>a.value!==""&&!Number.isNaN(+a.value)),r=p(()=>{switch(e.field){case"birth_year":return i.value||h.value&&(e.author.death_year!==""&&+a.value<e.author.death_year||e.author.death_year==="");case"death_year":return e.author.birth_year!==""&&(a.value===""||h.value&&a.value>=e.author.birth_year)||e.author.birth_year===""&&a.value==="";case"name":return a.value;default:return!0}}),t=f(!1),u=()=>{t.value=!0,q().then(()=>{document.getElementById("author-field").focus()})},l=()=>{a.value!==e.author[e.field]&&(r.value?(a.value!==""&&(e.field==="birth_year"||e.field==="death_year")&&(a.value=parseInt(a.value)),o("update-field",a.value)):a.value=e.author[e.field]),t.value=!1};return(d,m)=>t.value?(c(),_("div",J,[S(n("input",{type:"text",class:D({error:!V(r)}),"onUpdate:modelValue":m[0]||(m[0]=w=>a.value=w),id:"author-field",onKeyup:j(l,["enter"]),onFocusout:l},null,42,P),[[T,a.value]])])):(c(),_("div",{key:0,onContextmenu:B(u,["right","prevent"])},C(a.value!==""&&a.value!==null&&a.value!==void 0?a.value:"-"),41,H))}};var y=F(Q,[["__scopeId","data-v-eca2ae4c"]]);const R=s=>(M("data-v-83f1dcc2"),s=s(),O(),s),X={class:"tableWrapper"},Z=R(()=>n("div",{class:"tip"},[n("div",null,[G(" To edit "),n("img",{src:"https://img.icons8.com/fluency/48/000000/mouse-right-click.png"})])],-1)),E={setup(s){const o=Y(),e=p(()=>o.state.authors),a=f("author"),i=(r,t,u)=>{t[u]=r,o.dispatch("updateAuthorData",{id:t.id,name:t.name,field:u,value:r})},h=p(()=>{const r=Object.entries(e.value).map(([t,u])=>x(g({},u),{name:t}));switch(a.value){case"author":return r==null?void 0:r.sort((t,u)=>{var l;return(l=t.name)==null?void 0:l.localeCompare(u.name)});case"birth":return r==null?void 0:r.sort((t,u)=>t.birth_year-u.birth_year);case"death":return r==null?void 0:r.sort((t,u)=>typeof t.death_year=="number"&&typeof u.death_year=="number"?t.death_year-u.death_year:!1);case"books":return r==null?void 0:r.sort((t,u)=>t.books.length-u.books.length);default:return[]}});return(r,t)=>{const u=L("app-link");return c(),_("div",null,[n("div",X,[n("table",null,[n("thead",null,[n("tr",null,[n("th",{onClick:t[0]||(t[0]=l=>a.value="author")},"Author"),n("th",{onClick:t[1]||(t[1]=l=>a.value="birth")},"Year of birth"),n("th",{onClick:t[2]||(t[2]=l=>a.value="death")},"Year of death"),n("th",{onClick:t[3]||(t[3]=l=>a.value="books")},"Books")])]),n("tbody",null,[(c(!0),_(K,null,z(V(h),l=>(c(),_("tr",{key:l.id},[n("td",null,[v(u,{to:{name:"author",params:{authorId:l.id}}},{default:W(()=>[v(y,{onUpdateField:d=>i(d,l,"name"),field:"name",author:l},null,8,["onUpdateField","author"])]),_:2},1032,["to"])]),n("td",null,[v(y,{onUpdateField:d=>i(d,l,"birth_year"),field:"birth_year",author:l},null,8,["onUpdateField","author"])]),n("td",null,[v(y,{onUpdateField:d=>i(d,l,"death_year"),field:"death_year",author:l},null,8,["onUpdateField","author"])]),n("td",null,C(l.books.length),1)]))),128))])])]),Z])}}};var ae=F(E,[["__scopeId","data-v-83f1dcc2"]]);export{ae as default};
