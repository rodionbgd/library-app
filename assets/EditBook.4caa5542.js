var T=Object.defineProperty;var S=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var j=(r,l,t)=>l in r?T(r,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[l]=t,w=(r,l)=>{for(var t in l||(l={}))z.call(l,t)&&j(r,t,l[t]);if(S)for(var t of S(l))P.call(l,t)&&j(r,t,l[t]);return r};import{_ as O,r as q,a as C,c as E,w as Y,o as x,b as V,d as o,e as m,v as k,u as n,n as U,f as A,g as R,h as D,p as F,i as L,j as G,k as H,F as J,l as Q,m as N,R as W,q as X,s as Z,t as tt}from"./index.0aadcd2b.js";const M=r=>(F("data-v-1f326d43"),r=r(),L(),r),et={class:"d-flex w-90percent"},ot=["onKeyup"],at=["onKeyup"],st=["onKeyup"],rt={class:"d-flex flex-auto"},nt=M(()=>o("i",{class:"fa-regular fa-trash-can"},null,-1)),ut=[nt],lt=M(()=>o("i",{class:"fa-regular fa-pen-to-square"},null,-1)),dt=[lt],it={props:{author:{type:Object,default:()=>({})},authors:{type:Array,default:()=>[]}},emits:{"update-author":null,"remove-author":null},setup(r,{emit:l}){const t=r,a=q({name:t.author.name,birth_year:t.author.birth_year,death_year:t.author.death_year}),s=C(null),p=E(()=>a.name&&(a.name!==t.author.name||a.birth_year!==t.author.birth_year||a.death_year!==t.author.death_year)),y=C(!0);Y(()=>a.name,()=>{y.value=!a.name||!t.authors.find(h=>h===a.name)});const v=h=>!h||Number.isInteger(Number(h)),B=E(()=>y.value&&v(a.birth_year)&&v(a.death_year)),f=()=>{if(!p.value)return;const{name:h,birth_year:d,death_year:i}=a;l("update-author",{name:h,birth_year:d,death_year:i}),Object.keys(t.author).length||Object.keys(a).forEach(u=>{a[`${u}`]="",s.value.focus()})},g=()=>{l("remove-author")};return(h,d)=>(x(),V("section",null,[o("div",et,[m(o("input",{ref_key:"authorEl",ref:s,type:"text",class:U(["form-control",{error:!y.value}]),placeholder:"+Add Author name","onUpdate:modelValue":d[0]||(d[0]=i=>n(a).name=i),onKeyup:A(f,["enter"])},null,42,ot),[[k,n(a).name]]),m(o("input",{type:"text",class:U(["form-control",{error:!v(n(a).birth_year)}]),placeholder:"+Add Birth year","onUpdate:modelValue":d[1]||(d[1]=i=>n(a).birth_year=i),onKeyup:A(f,["enter"])},null,42,at),[[k,n(a).birth_year]]),m(o("input",{type:"text",class:U(["form-control",{error:!v(n(a).death_year)}]),placeholder:"+Add Death year","onUpdate:modelValue":d[2]||(d[2]=i=>n(a).death_year=i),onKeyup:A(f,["enter"])},null,42,st),[[k,n(a).death_year]])]),o("div",rt,[m(o("button",{type:"button",class:"edit-btn tm-social-link",onClick:g,onKeyup:d[3]||(d[3]=A(D(()=>{},["prevent"]),["enter"]))},ut,544),[[R,Object.keys(t.author).length]]),m(o("button",{type:"button",class:"edit-btn",onClick:f},dt,512),[[R,n(p)&&n(B)]])])]))}};var I=O(it,[["__scopeId","data-v-1f326d43"]]);const $=r=>(F("data-v-3a24771c"),r=r(),L(),r),ct={class:"box"},pt={class:"modal__text"},ht={class:"form-group"},_t=$(()=>o("p",{class:"modal__title"},"Title",-1)),mt=$(()=>o("p",null,"Price",-1)),yt=$(()=>o("p",{class:"modal__title"},"Authors",-1)),vt={props:{bookId:{type:Number,required:!0}},setup(r){const l=r,t=X(),a=Z(),s=q({title:"",price:"",rate:0,authors:[]});G(()=>{var e,u,c,_,b,K;document.body.addEventListener("keydown",i),s.title=(e=p.value)==null?void 0:e.title,s.price=(u=p.value)==null?void 0:u.price,s.rate=(_=(c=p.value)==null?void 0:c.rate)!=null?_:1,s.authors=(K=(b=p.value)==null?void 0:b.authors)!=null?K:[]}),H(()=>{document.body.removeEventListener("keydown",i)});const p=E(()=>t.state.books.find(e=>e.id===l.bookId)),y=E(()=>s.authors.map(e=>e.name)),v=(e,u)=>{u!==void 0&&s.authors[u].name!==e.name&&(s.authors[u]=e,t.dispatch("updateAuthors"))},B=e=>{s.authors.splice(e,1)},f=e=>{!Object.keys(e).length||(s.authors=[...s.authors,e])},g=()=>{const{authors:e,title:u,rate:c}=s,_={authors:e,title:u,rate:c};p.value?t.dispatch("updateBook",w(w({},p.value),_)):t.dispatch("addBook",_),d()},h=e=>{s.rate=e},d=()=>{a.back()},i=e=>{e.code==="Escape"&&(d(),e.preventDefault())};return(e,u)=>(x(),V("div",ct,[o("div",{class:"modal-container",onClick:d},[o("div",{class:"modal-custom",onClick:u[2]||(u[2]=D(()=>{},["stop"]))},[o("div",pt,[o("form",null,[o("div",ht,[_t,m(o("input",{"data-test":"title",type:"text",class:"form-control","onUpdate:modelValue":u[0]||(u[0]=c=>n(s).title=c)},null,512),[[k,n(s).title]]),mt,m(o("input",{"data-test":"price",type:"text",class:"form-control","onUpdate:modelValue":u[1]||(u[1]=c=>n(s).price=c)},null,512),[[k,n(s).price]]),yt,(x(!0),V(J,null,Q(n(s).authors,(c,_)=>(x(),tt(I,{class:"d-flex",key:_,author:c,authors:n(y),onUpdateAuthor:b=>v(b,_),onRemoveAuthor:b=>B(_)},null,8,["author","authors","onUpdateAuthor","onRemoveAuthor"]))),128)),N(I,{class:"d-flex",authors:n(y),onUpdateAuthor:f},null,8,["authors"])]),o("div",null,[N(W,{onUpdateRate:h,rate:n(s).rate},null,8,["rate"])])])]),o("div",{class:"d-flex justify-content-center mt-2"},[o("button",{class:"modal__btn",onClick:g},"Save book")]),o("button",{class:"modal__btn link-2 mt-3rem",onClick:d})])])]))}};var kt=O(vt,[["__scopeId","data-v-3a24771c"]]);export{kt as default};
