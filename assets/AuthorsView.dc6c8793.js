import{_ as b,d as g,a as f,c as u,o as p,e as c,z as k,j as F,g as A,v as C,f as l,n as V,h as x,i as T,B as U,F as I,p as $,s as N,t as B,u as D,C as z,q as _,D as S,E as W,A as K}from"./index.5e67c1c0.js";const j=["onContextmenu"],M={key:1},O=["onKeyup"],Y=g({props:{author:null,field:null},emits:["update-field"],setup(i,{emit:v}){const o=i,t=f(o.author[o.field]),s=u(()=>t.value===""&&o.author.death_year===""),h=u(()=>t.value!==""&&!Number.isNaN(+t.value)),a=u(()=>{switch(o.field){case"birth_year":return s.value||h.value&&(o.author.death_year!==""&&+t.value<o.author.death_year||o.author.death_year==="");case"death_year":return o.author.birth_year!==""&&(t.value===""||h.value&&t.value>=o.author.birth_year)||o.author.birth_year===""&&t.value==="";case"name":return t.value;default:return!0}}),e=f(!1),d=()=>{e.value=!0,U().then(()=>{const n=document.getElementById("author-field");n&&n.focus()})},r=()=>{t.value!==o.author[o.field]&&(a.value?(t.value!==""&&(o.field==="birth_year"||o.field==="death_year")&&(t.value=parseInt(`${t.value}`)),v("update-field",t.value)):t.value=o.author[o.field]),e.value=!1};return(n,y)=>e.value?(p(),c("div",M,[A(l("input",{type:"text",class:V({error:!x(a)}),"onUpdate:modelValue":y[0]||(y[0]=w=>t.value=w),id:"author-field",onKeyup:T(r,["enter"]),onFocusout:r},null,42,O),[[C,t.value]])])):(p(),c("div",{key:0,onContextmenu:F(d,["right","prevent"])},k(t.value!==""&&t.value!==null&&t.value!==void 0?t.value:"-"),41,j))}});var m=b(Y,[["__scopeId","data-v-58a26e81"]]);const q=i=>(N("data-v-2ee3ce1d"),i=i(),B(),i),H={class:"tableWrapper"},L=q(()=>l("div",{class:"tip"},[l("div",null,[W(" To edit "),l("img",{src:"https://img.icons8.com/fluency/48/000000/mouse-right-click.png"})])],-1)),P=g({setup(i){const v=D(),o=u(()=>v.state.authors),t=f("author"),s=(a,e,d)=>{e[d]=a,v.dispatch(K.UPDATE_AUTHOR_DATA,{id:e.id,name:e.name,field:d,value:a})},h=u(()=>{const a=Object.entries(o.value).map(([e,d])=>({...d,name:e}));switch(t.value){case"author":return a==null?void 0:a.sort((e,d)=>{var r;return(r=e.name)==null?void 0:r.localeCompare(d.name)});case"birth":return a==null?void 0:a.sort((e,d)=>+e.birth_year-+d.birth_year);case"death":return a==null?void 0:a.sort((e,d)=>typeof e.death_year=="number"&&typeof d.death_year=="number"?e.death_year-d.death_year:0);case"books":return a==null?void 0:a.sort((e,d)=>e.books.length-d.books.length);default:return[]}});return(a,e)=>{const d=z("app-link");return p(),c("div",null,[l("div",H,[l("table",null,[l("thead",null,[l("tr",null,[l("th",{onClick:e[0]||(e[0]=r=>t.value="author")},"Author"),l("th",{onClick:e[1]||(e[1]=r=>t.value="birth")},"Year of birth"),l("th",{onClick:e[2]||(e[2]=r=>t.value="death")},"Year of death"),l("th",{onClick:e[3]||(e[3]=r=>t.value="books")},"Books")])]),l("tbody",null,[(p(!0),c(I,null,$(x(h),r=>(p(),c("tr",{key:r.id},[l("td",null,[_(d,{to:{name:"author",params:{authorId:r.id}}},{default:S(()=>[_(m,{onUpdateField:n=>s(n,r,"name"),field:"name",author:r},null,8,["onUpdateField","author"])]),_:2},1032,["to"])]),l("td",null,[_(m,{onUpdateField:n=>s(n,r,"birth_year"),field:"birth_year",author:r},null,8,["onUpdateField","author"])]),l("td",null,[_(m,{onUpdateField:n=>s(n,r,"death_year"),field:"death_year",author:r},null,8,["onUpdateField","author"])]),l("td",null,k(r.books.length),1)]))),128))])])]),L])}}});var G=b(P,[["__scopeId","data-v-2ee3ce1d"]]);export{G as default};
