var T=Object.defineProperty,U=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var k=(s,r,e)=>r in s?T(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e,g=(s,r)=>{for(var e in r||(r={}))$.call(r,e)&&k(s,e,r[e]);if(b)for(var e of b(r))N.call(r,e)&&k(s,e,r[e]);return s},F=(s,r)=>U(s,I(r));import{_ as x,d as A,a as f,c as p,o as _,e as c,z as C,j as B,g as D,v as S,f as u,n as K,h as V,i as j,B as z,F as M,p as O,s as Y,t as q,u as H,C as L,q as h,D as P,E as R,A as W}from"./index.ef3d6486.js";const G=["onContextmenu"],J={key:1},Q=["onKeyup"],X=A({props:{author:null,field:null},emits:["update-field"],setup(s,{emit:r}){const e=s,a=f(e.author[e.field]),i=p(()=>a.value===""&&e.author.death_year===""),v=p(()=>a.value!==""&&!Number.isNaN(+a.value)),l=p(()=>{switch(e.field){case"birth_year":return i.value||v.value&&(e.author.death_year!==""&&+a.value<e.author.death_year||e.author.death_year==="");case"death_year":return e.author.birth_year!==""&&(a.value===""||v.value&&a.value>=e.author.birth_year)||e.author.birth_year===""&&a.value==="";case"name":return a.value;default:return!0}}),t=f(!1),n=()=>{t.value=!0,z().then(()=>{const d=document.getElementById("author-field");d&&d.focus()})},o=()=>{a.value!==e.author[e.field]&&(l.value?(a.value!==""&&(e.field==="birth_year"||e.field==="death_year")&&(a.value=parseInt(`${a.value}`)),r("update-field",a.value)):a.value=e.author[e.field]),t.value=!1};return(d,m)=>t.value?(_(),c("div",J,[D(u("input",{type:"text",class:K({error:!V(l)}),"onUpdate:modelValue":m[0]||(m[0]=w=>a.value=w),id:"author-field",onKeyup:j(o,["enter"]),onFocusout:o},null,42,Q),[[S,a.value]])])):(_(),c("div",{key:0,onContextmenu:B(n,["right","prevent"])},C(a.value!==""&&a.value!==null&&a.value!==void 0?a.value:"-"),41,G))}});var y=x(X,[["__scopeId","data-v-58a26e81"]]);const Z=s=>(Y("data-v-2ee3ce1d"),s=s(),q(),s),E={class:"tableWrapper"},ee=Z(()=>u("div",{class:"tip"},[u("div",null,[R(" To edit "),u("img",{src:"https://img.icons8.com/fluency/48/000000/mouse-right-click.png"})])],-1)),te=A({setup(s){const r=H(),e=p(()=>r.state.authors),a=f("author"),i=(l,t,n)=>{t[n]=l,r.dispatch(W.UPDATE_AUTHOR_DATA,{id:t.id,name:t.name,field:n,value:l})},v=p(()=>{const l=Object.entries(e.value).map(([t,n])=>F(g({},n),{name:t}));switch(a.value){case"author":return l==null?void 0:l.sort((t,n)=>{var o;return(o=t.name)==null?void 0:o.localeCompare(n.name)});case"birth":return l==null?void 0:l.sort((t,n)=>+t.birth_year-+n.birth_year);case"death":return l==null?void 0:l.sort((t,n)=>typeof t.death_year=="number"&&typeof n.death_year=="number"?t.death_year-n.death_year:0);case"books":return l==null?void 0:l.sort((t,n)=>t.books.length-n.books.length);default:return[]}});return(l,t)=>{const n=L("app-link");return _(),c("div",null,[u("div",E,[u("table",null,[u("thead",null,[u("tr",null,[u("th",{onClick:t[0]||(t[0]=o=>a.value="author")},"Author"),u("th",{onClick:t[1]||(t[1]=o=>a.value="birth")},"Year of birth"),u("th",{onClick:t[2]||(t[2]=o=>a.value="death")},"Year of death"),u("th",{onClick:t[3]||(t[3]=o=>a.value="books")},"Books")])]),u("tbody",null,[(_(!0),c(M,null,O(V(v),o=>(_(),c("tr",{key:o.id},[u("td",null,[h(n,{to:{name:"author",params:{authorId:o.id}}},{default:P(()=>[h(y,{onUpdateField:d=>i(d,o,"name"),field:"name",author:o},null,8,["onUpdateField","author"])]),_:2},1032,["to"])]),u("td",null,[h(y,{onUpdateField:d=>i(d,o,"birth_year"),field:"birth_year",author:o},null,8,["onUpdateField","author"])]),u("td",null,[h(y,{onUpdateField:d=>i(d,o,"death_year"),field:"death_year",author:o},null,8,["onUpdateField","author"])]),u("td",null,C(o.books.length),1)]))),128))])])]),ee])}}});var oe=x(te,[["__scopeId","data-v-2ee3ce1d"]]);export{oe as default};
